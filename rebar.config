% -*- erlang -*-
{sub_dirs, ["rel", "apps/*"]}.
{lib_dirs, ["apps"]}.
{cover_enabled, true}.
{erl_opts, [debug_info, warnings_as_errors, {parse_transform, lager_transform}]}.
{edoc_opts, [{dir, "../../doc"}]}.
{eunit_opts, [{report,{eunit_surefire,[{dir,"."}]}}]}.
{deps,
 [
  {lager, ".*", {git, "https://github.com/basho/lager", {ref,"cbf6679c6a693772fd1629c9cdc093e4c6c4ebf8"}}},
  {cuttlefish, ".*", {git, "https://github.com/tsloughter/cuttlefish.git", {branch, "develop"}}},
  {ranch, "1.1.0"},
  {cowboy, "1.0.2"},
  {jsx, "1.4.5"},
  {msgpack, ".*", {git, "https://github.com/msgpack/msgpack-erlang.git", {tag, "0.3.3"}}},
  {mmath, ".*", {git, "https://github.com/DalmatinerDB/mmath.git", {branch, "master"}}},
  {mmath, "0.1.7"},
  {dqe, ".*", {git, "https://github.com/dalmatinerdb/dqe.git", {tag, "0.1.13"}}}

 ]}.

{plugin_dir, "deps/cuttlefish/src"}.
{plugins, [cuttlefish_rebar_plugin]}.

{profiles,
 [{eqc,
   [{plugins, [rebar3_eqc]},
    {deps, [fqc]}]}]}.

{xref_checks, [undefined_function_calls, undefined_functions,
               locals_not_used, % exports_not_used, that is a problem with having multiple apps
               deprecated_function_calls, deprecated_functions]}.

{overrides,
 [
  %% R18
  {override, edown,
   [{erl_opts, [debug_info]}]},
  {override, eper,
   [{erl_opts, [debug_info]}]},
  {override, pooler,
   [{erl_opts,
     [{platform_define, "^[0-9]+", namespaced_types},
      debug_info,
      inline]}]},
  %% Normal
  {override, setup, [{post_hooks, []}]}]}.
